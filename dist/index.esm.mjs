var t=/*#__PURE__*/function(){function t(){}return t.init=function(t){this.apiKey=t},t.initBackend=function(t){t&&(this.BASE_URL=t.baseUrl)},t.setSessionId=function(t){this.sessionId=t},t.registerSession=function(){var t=this,e=this.BASE_URL+"/verify";return new Promise(function(i,n){fetch(e,{method:"GET",headers:{"api-key":t.apiKey}}).then(function(t){return t.json()}).then(function(t){i(t)}).catch(function(t){return n(t)})})},t.registerEvent=function(t){var e=this.BASE_URL+"/events?session_id="+this.sessionId,i={method:"POST",headers:{"api-key":this.apiKey,"Content-Type":"application/json"},body:JSON.stringify({data:t})};return new Promise(function(t,n){fetch(e,i).then(function(t){return t.json()}).then(function(e){t(e)}).catch(function(t){return n(t)})})},t}();function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=Array(e);i<e;i++)n[i]=t[i];return n}t.apiKey=void 0,t.sessionId=void 0,t.BASE_URL=void 0;var i=/*#__PURE__*/function(){function t(t){var e,i,n;this.isTrusted=void 0,this.altKey=void 0,this.button=void 0,this.buttons=void 0,this.clientX=void 0,this.clientY=void 0,this.ctrlKey=void 0,this.detail=void 0,this.element=void 0,this.layerX=void 0,this.layerY=void 0,this.metaKey=void 0,this.movementX=void 0,this.movementY=void 0,this.offsetX=void 0,this.offsetY=void 0,this.pageX=void 0,this.pageY=void 0,this.pointerType=void 0,this.screenX=void 0,this.screenY=void 0,this.shiftKey=void 0,this.x=void 0,this.y=void 0,this.timestamp=void 0,this.isTrusted=t.isTrusted,this.altKey=t.altKey,this.button=t.button,this.buttons=t.buttons,this.clientX=t.clientX,this.clientY=t.clientY,this.ctrlKey=t.ctrlKey,this.detail=t.detail,this.element={tagName:null==(e=t.target)?void 0:e.tagName,id:null==(i=t.target)?void 0:i.id,disabled:null==(n=t.target)?void 0:n.disabled},this.layerX=t.layerX,this.layerY=t.layerY,this.metaKey=t.metaKey,this.movementX=t.movementX,this.movementY=t.movementY,this.offsetX=t.offsetX,this.offsetY=t.offsetY,this.pageX=t.pageX,this.pageY=t.pageY,this.pointerType=t.pointerType,this.screenX=t.screenX,this.screenY=t.screenY,this.shiftKey=t.shiftKey,this.x=t.x,this.y=t.y,this.timestamp=Date.now()}return t.prototype.getData=function(){return{isTrusted:this.isTrusted,altKey:this.altKey,button:this.button,buttons:this.buttons,clientX:this.clientX,clientY:this.clientY,ctrlKey:this.ctrlKey,detail:this.detail,element:this.element,layerX:this.layerX,layerY:this.layerY,metaKey:this.metaKey,movementX:this.movementX,movementY:this.movementY,offsetX:this.offsetX,offsetY:this.offsetY,pageX:this.pageX,pageY:this.pageY,pointerType:this.pointerType,screenX:this.screenX,screenY:this.screenY,shiftKey:this.shiftKey,timestamp:this.timestamp,x:this.x,y:this.y}},t}(),n=/*#__PURE__*/function(){function n(){var n=this;this.documentBody=void 0,this.currentTime=void 0,this.BOUNCE=500,this.SEND_FREQUENCY=2e4,this.sequenceData=void 0,this.intervalObj=void 0,this.initialize=function(){n.currentTime=Date.now(),n.intervalObj=setInterval(function(){n.sendData()},n.SEND_FREQUENCY),n.attachMouseEvent()},this.sendData=function(){var i=!0;if(Array.isArray(n.sequenceData))for(var s,o=function(t){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(i)return(i=i.call(t)).next.bind(i);if(Array.isArray(t)||(i=function(t,i){if(t){if("string"==typeof t)return e(t,i);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e(t,i):void 0}}(t))){i&&(t=i);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(n.sequenceData);!(s=o()).done;){var r=s.value;if(Array.isArray(r)&&r.length>0){i=!1;break}}i||t.registerEvent(n.sequenceData),n.initSequenceData()},this.mouseClickEvent=function(t){var e=Date.now(),s=new i(t);e-n.currentTime<n.BOUNCE?n.sequenceData[n.sequenceData.length-1].push(s.getData()):n.sequenceData.push([s.getData()]),n.currentTime=e},this.stopEvents=function(){n.intervalObj&&(clearInterval(n.intervalObj),n.intervalObj=null)},this.documentBody=document.body,this.sequenceData=[[]],this.currentTime=0,this.intervalObj=null}var s=n.prototype;return s.initSequenceData=function(){this.sequenceData=[[]]},s.attachMouseEvent=function(){this.documentBody&&this.documentBody.addEventListener("pointerup",this.mouseClickEvent)},n}(),s=/*#__PURE__*/function(){function e(e,i){this.apiKey=void 0,this.captureObj=void 0,this.apiKey=e,this.captureObj=new n,i&&i.backend&&(t.init(e),t.initBackend(i.backend))}return e.prototype.initialize=function(){var e=this;t.registerSession().then(function(i){i&&(e.captureObj.initialize(),i.session_id&&t.setSessionId(i.session_id))})},e}();export{s as TraceEvent};
