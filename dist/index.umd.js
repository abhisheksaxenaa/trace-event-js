!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t||self).traceEvent={})}(this,function(t){var e=/*#__PURE__*/function(){function t(){}return t.init=function(t){this.apiKey=t},t.initBackend=function(t){t&&(this.BASE_URL=t.baseUrl)},t.setSessionId=function(t){this.sessionId=t},t.registerSession=function(){var t=this,e=this.BASE_URL+"/verify";return new Promise(function(i,n){fetch(e,{method:"GET",headers:{"api-key":t.apiKey}}).then(function(t){return t.json()}).then(function(t){i(t)}).catch(function(t){return n(t)})})},t.registerEvent=function(t){var e=this.BASE_URL+"/events?session_id="+this.sessionId,i={method:"POST",headers:{"api-key":this.apiKey,"Content-Type":"application/json"},body:JSON.stringify({data:t})};return new Promise(function(t,n){fetch(e,i).then(function(t){return t.json()}).then(function(e){t(e)}).catch(function(t){return n(t)})})},t}();function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=Array(e);i<e;i++)n[i]=t[i];return n}e.apiKey=void 0,e.sessionId=void 0,e.BASE_URL=void 0;var n=/*#__PURE__*/function(){function t(t){var e,i,n;this.isTrusted=void 0,this.altKey=void 0,this.button=void 0,this.buttons=void 0,this.clientX=void 0,this.clientY=void 0,this.ctrlKey=void 0,this.detail=void 0,this.element=void 0,this.layerX=void 0,this.layerY=void 0,this.metaKey=void 0,this.movementX=void 0,this.movementY=void 0,this.offsetX=void 0,this.offsetY=void 0,this.pageX=void 0,this.pageY=void 0,this.pointerType=void 0,this.screenX=void 0,this.screenY=void 0,this.shiftKey=void 0,this.x=void 0,this.y=void 0,this.timestamp=void 0,this.isTrusted=t.isTrusted,this.altKey=t.altKey,this.button=t.button,this.buttons=t.buttons,this.clientX=t.clientX,this.clientY=t.clientY,this.ctrlKey=t.ctrlKey,this.detail=t.detail,this.element={tagName:null==(e=t.target)?void 0:e.tagName,id:null==(i=t.target)?void 0:i.id,disabled:null==(n=t.target)?void 0:n.disabled},this.layerX=t.layerX,this.layerY=t.layerY,this.metaKey=t.metaKey,this.movementX=t.movementX,this.movementY=t.movementY,this.offsetX=t.offsetX,this.offsetY=t.offsetY,this.pageX=t.pageX,this.pageY=t.pageY,this.pointerType=t.pointerType,this.screenX=t.screenX,this.screenY=t.screenY,this.shiftKey=t.shiftKey,this.x=t.x,this.y=t.y,this.timestamp=Date.now()}return t.prototype.getData=function(){return{isTrusted:this.isTrusted,altKey:this.altKey,button:this.button,buttons:this.buttons,clientX:this.clientX,clientY:this.clientY,ctrlKey:this.ctrlKey,detail:this.detail,element:this.element,layerX:this.layerX,layerY:this.layerY,metaKey:this.metaKey,movementX:this.movementX,movementY:this.movementY,offsetX:this.offsetX,offsetY:this.offsetY,pageX:this.pageX,pageY:this.pageY,pointerType:this.pointerType,screenX:this.screenX,screenY:this.screenY,shiftKey:this.shiftKey,x:this.x,y:this.y}},t}(),s=/*#__PURE__*/function(){function t(){var t=this;this.documentBody=void 0,this.currentTime=void 0,this.BOUNCE=500,this.SEND_FREQUENCY=2e4,this.sequenceData=void 0,this.intervalObj=void 0,this.initialize=function(){t.currentTime=Date.now(),t.intervalObj=setInterval(function(){t.sendData()},t.SEND_FREQUENCY),t.attachMouseEvent()},this.sendData=function(){var n=!0;if(Array.isArray(t.sequenceData))for(var s,o=function(t){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=function(t,e){if(t){if("string"==typeof t)return i(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}(t))){e&&(t=e);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(t.sequenceData);!(s=o()).done;){var r=s.value;if(Array.isArray(r)&&r.length>0){n=!1;break}}n||e.registerEvent(t.sequenceData),t.initSequenceData()},this.mouseClickEvent=function(e){var i=Date.now(),s=new n(e);i-t.currentTime<t.BOUNCE?t.sequenceData[t.sequenceData.length-1].push(s.getData()):t.sequenceData.push([s.getData()]),t.currentTime=i},this.stopEvents=function(){t.intervalObj&&(clearInterval(t.intervalObj),t.intervalObj=null)},this.documentBody=document.body,this.sequenceData=[[]],this.currentTime=0,this.intervalObj=null}var s=t.prototype;return s.initSequenceData=function(){this.sequenceData=[[]]},s.attachMouseEvent=function(){this.documentBody&&this.documentBody.addEventListener("pointerup",this.mouseClickEvent)},t}();t.TraceEvent=/*#__PURE__*/function(){function t(t,i){this.apiKey=void 0,this.captureObj=void 0,this.apiKey=t,this.captureObj=new s,i&&i.backend&&(e.init(t),e.initBackend(i.backend))}return t.prototype.initialize=function(){var t=this;e.registerSession().then(function(i){i&&(t.captureObj.initialize(),i.session_id&&e.setSessionId(i.session_id))})},t}()});
